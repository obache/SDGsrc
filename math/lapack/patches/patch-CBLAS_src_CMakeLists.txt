$NetBSD: patch-CBLAS_src_CMakeLists.txt,v 1.2 2021/04/21 13:53:19 ryoon Exp $

Support combined build of shared and static libraries.

--- CBLAS/src/CMakeLists.txt.orig	2019-11-21 07:57:43.000000000 +0000
+++ CBLAS/src/CMakeLists.txt
@@ -116,7 +116,6 @@ list(REMOVE_DUPLICATES SOURCES)
 add_library(cblas ${SOURCES})
 set_target_properties(
   cblas PROPERTIES
-  LINKER_LANGUAGE C
   VERSION ${LAPACK_VERSION}
   SOVERSION ${LAPACK_MAJOR_VERSION}
   )
@@ -126,3 +125,17 @@ target_include_directories(cblas PUBLIC
 )
 target_link_libraries(cblas PRIVATE ${BLAS_LIBRARIES})
 lapack_install_library(cblas)
+
+if(BUILD_SHARED_LIBS AND BUILD_STATIC_LIBS)
+  add_library(cblas_static STATIC ${SOURCES})
+  set_target_properties(
+    cblas_static PROPERTIES
+    OUTPUT_NAME cblas
+    )
+  target_include_directories(cblas_static PUBLIC
+    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/../include>
+    $<INSTALL_INTERFACE:include>
+  )
+  target_link_libraries(cblas_static PRIVATE ${BLAS_LIBRARIES})
+  lapack_install_library(cblas_static)
+endif()
